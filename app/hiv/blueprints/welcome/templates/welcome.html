{% extends "base.html" %}
{% block head_end %}
{{ super() }}
<!-- display message if javascript is disabled -->
<noscript>
    <div class="bg-danger" style="margin-left:50px; margin-right:50px; margin-top:20px;
   margin-bottom:20px; padding-top:20px; padding-left:20px; padding-bottom:20px">
		<p class="text-danger"><span class="glyphicon glyphicon-warning-sign"></span><strong> Warning:</strong> You don't have JavaScript activated. For full functionality of our site JavaScript has to be enabled.</p>
		<a href="http://www.enable-javascript.com/" target="_blank">How to enable JavaScript?</a>
    </div>
</noscript>

 <!-- D3.js for plots -->
 <link href="/static/css/d3_plots.css" rel="stylesheet" type="text/css">
 <script src="/static/components/d3/d3.js" charset="utf-8"></script>

 <!-- d3-tip for tooltips -->
 <link rel="stylesheet" href="/static/css/d3-tip.css">
 <script type="text/javascript" src="/static/components/d3-tip/index.js"></script>

 <!-- maybe we have to put the snippet directly into single scripts, let's hope not -->
 <script type="text/javascript">
  <!-- nice IE has no way of finding a string in a list of strings (!) -->
  if (!Array.prototype.indexOf) {
     Array.prototype.indexOf = function(item) {
        var i = this.length;
        while (i--) {
           if (this[i] === item) return i;
        }
        return -1;
     }
  }

 <!-- JavaScript has no intrinsic way to determine numeric -->
 function isNumeric(n) {
   return !isNaN(parseFloat(n)) && isFinite(n);
 }
 </script>


<script type="text/javascript" src="/static/js/trees.js"></script>
<script type="text/javascript">
function loadTree(id, pname, region) {
 d3.xhr("/method/trees/")
  .header("Content-Type", "application/json")
  .post(
    JSON.stringify({patient: pname, region: region, treeFormat: "json"}),
    function(error, request) {
     var data = JSON.parse(request.responseText);
     d3.json(data.tree, function(error, tree) {
      data.tree = tree;      
      data.pname = pname;
      data.region = region;
      data.leafLabels = false;
      data.optimizeSpace = true;
      updateTree(id, data);
     });     
    });
}

function load() {
 loadTree("treeSvgAll", "all", "{{region}}");
}
</script>
{% endblock %}
{% block body_attributes %}onload="load()"{% endblock %}
{% block content %}
<div class="container" style="padding-top:20px; padding-left:20px">
    <div class="jumbotron">
		<h2 class="text-primary"><b>HIV EVO </b><small>Intrapatient HIV evolution</small></h2>
	</div>
	<div class="row">
		<div class="col-xs-6">
		<h4 class="text-muted"><span class="glyphicon glyphicon-info-sign"></span> About</h4>
<p style="text-align:justify">
HIV is one of the most rapidly evolving organisms known. By continuously changing its genome, the virus evades the host immune response and establishes a chronic infection. In order to quantitatively monitor and study HIV evolution, we have sequenced the entire genome of the diverse virus population in several individuals at many consecutive time points to a depth greater 1000.<br>

The <a href="/people/">project</a> is a collaboration between the labs of <a href="http://neherlab.wordpress.com">Richard Neher</a> and <a href="http://ki.se/en/mtc/jan-albert-group">Jan Albert</a> and is funded by the ERC through grant HIVEVO 260686. This website is meant to provide convenient access to the data, methods, and analysis.
 </p>
		</div>
		<div class="col-xs-6">
		<h4 class="text-muted"><span class="glyphicon glyphicon-question-sign"></span> How to get started</h4>

<p style="text-align:justify">The primary access to the data is organized by <a href="/patient/p1/">patient</a> and provides a summary of clinical parameteres, phylogenetic patterns, dynamics of single nucleotide variants and sequencing statistics. A summary of the sequencing methods and quality control can be found in the tab <a href="/sequencing/">Methods</a>. If this is the first time you are visiting this website we recommend to start with our <a href="/tutorial/">tutorial</a>. Full access to the data -- including mapped sequencing reads as well as processed data -- is provided in our <a href="">download section</a>.</p>
		</div>
	</div>
<hr>
<div class="row">
 <h4 class="text-primary"><span class="glyphicon glyphicon-user" style="padding-left:15px"></span> <a href="/patient/p1/">Patients</a></h4>
  <div class="well text-muted" style="margin-left:15px; margin-right:15px; margin-top:20px">
    <span class="glyphicon glyphicon-arrow-right"></span> 
    Select a patient in the following table to access a summary of HIV evolution in each of our study participants. Click <a href="/patient/p1/">here</a> to show data of patient p1. 
  </div>

  <div class="col-xs-6 col-sm-6">
    <p>Overview of patient specific data:</p>
    <table class="table">
    <thead>
    <tr>
    <th rowspan="2">patient</th>
    <th rowspan="2">subtype</th>
    <th rowspan="2">&#35; samples</th>
    <th rowspan="2">1st sample</th>
    <th rowspan="2">last sample</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td></td>
    <td></td>
    <td></td>
    <td colspan="2" align="center">[days since infection]</td>
    </tr>
    {% for row in patientTable %}
    <tr>
    <td><a href="/patient/{{row['Patient']}}/">{{row['Patient']}}</a></td>
    <td>{{row['Subtype']}}</td>
    <td>{{row['# samples']}}</td>
    <td>{{row['1st sample']}}</td>
    <td>{{row['last sample']}}</td>
    </tr>
    {% endfor %}
    </tbody>
    </table>
  </div>
  <div class="col-sm-5">
   <p style="text-align:justify"><b>Example:</b> Phylogeny of samples in the <strong>{{region}}</strong> region, colored by patient.</p>
    <svg id="treeSvgAll"></svg>
  </div>
</div>
<hr>
<div class="row">
  <div class="col-xs-12">
   <h4 class="text-primary"><span class="glyphicon glyphicon-zoom-in"></span> <a href="/region/V3/">Genomic regions</a></h4>
    <hr>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
   <h4 class="text-primary"><span class="glyphicon glyphicon-book"></span> <a href="/method/">Methods of analysis</a></h4>
    <hr>
  </div>
</div>
<div class="row">
  <div class="col-xs-12">
    <h4 class="text-primary"><span class="glyphicon glyphicon-download-alt"></span> <a href="/data/">Data access</a></h4>
    <hr>
  </div>
</div>

<!-- container end -->
</div>
<!-- NOTE: the tag below is a trick for the tree plot -->
<div id="switchColorLinkPatient" class="active"></div>
{% endblock %}


